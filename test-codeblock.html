<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeBlock Test</title>
    <script src="https://unpkg.com/react@19/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@19/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/shiki@3.9.2/dist/index.browser.js"></script>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
        }

        .test-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }

        .status {
            padding: 8px 12px;
            border-radius: 4px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status.loading {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>CodeBlock Component Test</h1>

        <div class="test-section">
            <div class="test-title">Test 1: Basic JavaScript Code</div>
            <div id="test1"></div>
        </div>

        <div class="test-section">
            <div class="test-title">Test 2: Python Code with Line Numbers</div>
            <div id="test2"></div>
        </div>

        <div class="test-section">
            <div class="test-title">Test 3: TypeScript Code</div>
            <div id="test3"></div>
        </div>
    </div>

    <script type="text/babel">
        // Mock the required dependencies
        const cn = (...classes) => classes.filter(Boolean).join(' ');

        // Mock Button component
        const Button = ({ children, className, onClick, ...props }) => {
            return React.createElement('button', {
                className: `inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background hover:bg-accent hover:text-accent-foreground h-10 w-10 ${className || ''}`,
                onClick,
                ...props
            }, children);
        };

        // Mock icons
        const CheckIcon = ({ size = 16 }) => React.createElement('svg', {
            width: size,
            height: size,
            viewBox: '0 0 24 24',
            fill: 'none',
            stroke: 'currentColor',
            strokeWidth: 2
        }, React.createElement('polyline', { points: '20,6 9,17 4,12' }));

        const CopyIcon = ({ size = 16 }) => React.createElement('svg', {
            width: size,
            height: size,
            viewBox: '0 0 24 24',
            fill: 'none',
            stroke: 'currentColor',
            strokeWidth: 2
        }, React.createElement('rect', { x: 9, y: 9, width: 13, height: 13, rx: 2, ry: 2 }),
            React.createElement('path', { d: 'M5,15H4a2,2,0,0,1-2-2V4A2,2,0,0,1,4,2H15a2,2,0,0,1,2,2V5' }));

        // Test status component
        const TestStatus = ({ status, message }) => {
            return React.createElement('div', {
                className: `status ${status}`
            }, message);
        };

        // Simple CodeBlock test component (without Shiki for this basic test)
        const SimpleCodeBlock = ({ code, language, showLineNumbers = false, children }) => {
            const [status, setStatus] = React.useState('loading');

            React.useEffect(() => {
                // Simulate async highlighting
                setTimeout(() => {
                    setStatus('success');
                }, 1000);
            }, []);

            if (status === 'loading') {
                return React.createElement('div', {
                    style: {
                        border: '1px solid #e0e0e0',
                        borderRadius: '6px',
                        padding: '16px',
                        backgroundColor: '#f8f9fa',
                        position: 'relative'
                    }
                },
                    React.createElement('div', {
                        style: { fontFamily: 'monospace', fontSize: '14px', color: '#666' }
                    }, 'Loading syntax highlighting...'),
                    children && React.createElement('div', {
                        style: { position: 'absolute', top: '8px', right: '8px' }
                    }, children));
            }

            return React.createElement('div', {
                style: {
                    border: '1px solid #e0e0e0',
                    borderRadius: '6px',
                    backgroundColor: '#f8f9fa',
                    position: 'relative',
                    overflow: 'hidden'
                }
            },
                React.createElement('pre', {
                    style: {
                        margin: 0,
                        padding: '16px',
                        fontSize: '14px',
                        fontFamily: 'monospace',
                        backgroundColor: 'transparent',
                        overflow: 'auto'
                    }
                }, React.createElement('code', null, code)),
                children && React.createElement('div', {
                    style: { position: 'absolute', top: '8px', right: '8px', display: 'flex', gap: '8px' }
                }, children));
        };

        // Copy button component
        const CopyButton = ({ code }) => {
            const [isCopied, setIsCopied] = React.useState(false);

            const handleCopy = async () => {
                try {
                    await navigator.clipboard.writeText(code);
                    setIsCopied(true);
                    setTimeout(() => setIsCopied(false), 2000);
                } catch (error) {
                    console.error('Failed to copy:', error);
                }
            };

            return React.createElement(Button, {
                onClick: handleCopy,
                style: { backgroundColor: 'rgba(255,255,255,0.9)' }
            }, React.createElement(isCopied ? CheckIcon : CopyIcon, { size: 14 }));
        };

        // Test cases
        const jsCode = `function fibonacci(n) {
  if (n <= 1) return n;
  return fibonacci(n - 1) + fibonacci(n - 2);
}

console.log(fibonacci(10));`;

        const pythonCode = `def quicksort(arr):
    if len(arr) <= 1:
        return arr
    
    pivot = arr[len(arr) // 2]
    left = [x for x in arr if x < pivot]
    middle = [x for x in arr if x == pivot]
    right = [x for x in arr if x > pivot]
    
    return quicksort(left) + middle + quicksort(right)

print(quicksort([3, 6, 8, 10, 1, 2, 1]))`;

        const tsCode = `interface User {
  id: number;
  name: string;
  email: string;
}

class UserService {
  private users: User[] = [];

  addUser(user: User): void {
    this.users.push(user);
  }

  getUserById(id: number): User | undefined {
    return this.users.find(user => user.id === id);
  }
}`;

        // Render tests
        ReactDOM.render(
            React.createElement(React.Fragment, null,
                React.createElement(TestStatus, { status: 'success', message: 'CodeBlock component loaded successfully!' }),
                React.createElement(SimpleCodeBlock, {
                    code: jsCode,
                    language: 'javascript'
                }, React.createElement(CopyButton, { code: jsCode }))
            ),
            document.getElementById('test1')
        );

        ReactDOM.render(
            React.createElement(React.Fragment, null,
                React.createElement(TestStatus, { status: 'success', message: 'Python code with line numbers test!' }),
                React.createElement(SimpleCodeBlock, {
                    code: pythonCode,
                    language: 'python',
                    showLineNumbers: true
                }, React.createElement(CopyButton, { code: pythonCode }))
            ),
            document.getElementById('test2')
        );

        ReactDOM.render(
            React.createElement(React.Fragment, null,
                React.createElement(TestStatus, { status: 'success', message: 'TypeScript code test!' }),
                React.createElement(SimpleCodeBlock, {
                    code: tsCode,
                    language: 'typescript'
                }, React.createElement(CopyButton, { code: tsCode }))
            ),
            document.getElementById('test3')
        );
    </script>
</body>

</html>